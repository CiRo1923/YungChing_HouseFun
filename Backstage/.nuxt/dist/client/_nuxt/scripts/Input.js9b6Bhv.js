import{k as j,o as d,c as v,b as h,w as M,a as w,H as i,F as V,G as f,a6 as O,aa as Z,a5 as K,t as z,x as N,m as y,r as A,p as G}from"./entry.DC204dd0.js";import{a as H,_ as P,E as T}from"./mForm.css.C05YFVEc.js";import{n as b,d as U}from"./_prototype.DQ_cqdh2.js";const W=["id","type","inputMode","minlength","maxlength","placeholder","readonly","disabled","onBlur"],X={__name:"Input",props:{name:{type:String,default:null},type:{type:String,default:"text"},modelValue:{type:[String,Number],default:null},value:{type:[String,Number],default:null},rules:{type:Object,default:null},config:{type:Object,default:()=>{}},setClass:{type:Object,default:()=>{}}},emits:["update:modelValue","focusin","blur","input","keydown.enter"],setup(S,{emit:B}){const p=B,o=S,l=A(null),k=A(!1),a=y(()=>U({placeholder:"",length:null,minlength:null,maxlength:null,formatLength:null,isReadonly:!1,isDisabled:!1,isError:!1,inputMode:null,isExistClose:!0,inputChinese:!0,comma:!1,checkNotIsZero:!1,integer:!1},o.config)),x=y(()=>a.value.inputMode==="numeric"),E=y(()=>{const{formatLength:e,maxlength:s}=a.value;return e&&s?e.replace(/\{\s*(length|maxlength)\s*\}/g,(t,u)=>u==="length"?l.value?String(l.value.length):0:String(s)):null}),r=y(()=>({main:"",container:"",element:"",type:"",formatLength:"",frontAssist:"",rearAssist:"",suffix:"",error:"",...o.setClass})),I=e=>{const{inputMode:s}=a.value,t=!o.modelValue&&o.value?{value:o.value}:{},u=x.value?{inputmode:s}:{};return{...e,...t,...u}},D=async e=>{const s=e.target.value,{inputMode:t,checkNotIsZero:u,integer:n,inputChinese:C}=a.value,c={chinese:/[\u4e00-\u9fa5０-９Ａ-Ｚａ-ｚ～！＠＃＄％︿＆＊（）＿｜｛｝［］＜＞？／＊＼＋－]/g,number:n?/[^0-9]/g:/[^0-9.]/g},g=(/numeric/.test(t)||!C)&&c.chinese.test(s);if(await G(),x.value){const m=c.number.test(s)?s.replace(c.number,""):s;l.value=u&&n&&/^0/.test(m)||u&&/^0\d/.test(m)?m.replace(/^0+/,""):m}else g&&(l.value=s.replace(c.chinese,""));p("input",e)},F=e=>{e.preventDefault(),p("keydown.enter")},$=(e,s)=>{const{comma:t,checkNotIsZero:u}=a.value,{type:n}=e,C=!!s,c=n==="focusin",g=n==="blur",m=t&&(l.value!==""||l.value!=null);if((c||g)&&(k.value=!k.value),c&&m&&(l.value=b.remove(l.value,!1)),g){x.value&&(l.value=u&&/^0\.$/.test(l.value)?l.value.replace(/^0\.$/,""):l.value);const _=m?b.remove(l.value,!1):l.value;p("update:modelValue",_),l.value=m?b.add(l.value,!1):l.value}p(n,e,C)},L=e=>{const{comma:s}=a.value,t=s&&e!==""&&e!=null;l.value=t?b.add(e,!1):e},R=()=>{l.value=null};return j(()=>o.modelValue,e=>{L(e)},{immediate:!0}),(e,s)=>(d(),v("div",{class:i(["m-form overflow-hidden",r.value.main])},[h(N(H),{name:o.name,type:o.type,modelValue:l.value,"onUpdate:modelValue":s[3]||(s[3]=t=>l.value=t),rules:o.rules},{default:M(({field:t,errorMessage:u})=>[w("div",{class:i(["m-form-container",r.value.container])},[w("div",{class:i(["m-form-element",[r.value.element,{"--focus":k.value},{"--readonly":a.value.isReadonly},{"--disabled":a.value.isDisabled},{"--error":u||a.value.isError}]])},[e.$slots.frontAssist?(d(),v("div",{key:0,class:i(["m-form-assist shrink-0",r.value.frontAssist])},[V(e.$slots,"frontAssist")],2)):f("",!0),w("input",O({id:o.name,type:o.type,class:["m-form-type min-w-0 grow",r.value.type]},I(t),{inputMode:a.value.inputMode,minlength:a.value.minlength||a.value.length,maxlength:a.value.maxlength||a.value.length,placeholder:a.value.placeholder,readonly:a.value.isReadonly,disabled:a.value.isDisabled,autocomplete:"off",onFocusin:s[0]||(s[0]=n=>$(n)),onBlur:n=>$(n,u),onInput:s[1]||(s[1]=n=>D(n)),onKeydown:s[2]||(s[2]=Z(n=>F(n),["enter"]))}),null,16,W),a.value.isExistClose&&!a.value.isDisabled?(d(),v("button",{key:1,type:"button",class:i(["m-form-clear-button",{"--show":l.value}]),onClick:R},[h(K,{icon:"icon_xmark",class:"m-form-clear-icon"})],2)):f("",!0),E.value?(d(),v("span",{key:2,class:i(["m-form-length shrink-0",r.value.length])},z(E.value),3)):f("",!0),e.$slots.rearAssist?(d(),v("div",{key:3,class:i(["m-form-assist shrink-0",r.value.rearAssist])},[V(e.$slots,"rearAssist")],2)):f("",!0)],2),e.$slots.suffix?(d(),v("small",{key:0,class:i(["m-form-suffix shrink-0",r.value.suffix])},[V(e.$slots,"suffix",{maxlength:a.value.length||a.value.maxlength,length:l.value?l.value.length:0})],2)):f("",!0)],2)]),_:3},8,["name","type","modelValue","rules"]),h(N(T),{as:"span",name:o.name,class:i(["m-form-error",r.value.error])},{default:M(({message:t})=>[h(P,{message:t},null,8,["message"])]),_:1},8,["name","class"])],2))}};export{X as _};
